#LDFLAGS=-L/home/lijiao/anaconda3/lib -L/share/data/lijiao/TRM_SOFTWARE/local/lib

CC = g++
subdir = pytest

#objects=test.o
#srcs = $(pathsubst %.o, %.cc, $(objects))

srcdir := ./cpp-lcurve/src
libdir := ./pylcurve/lib


srcs = $(srcdir)/libpylcurve.cc $(srcdir)/numface.cc $(srcdir)/set_star_grid.cc $(srcdir)/set_star_continuum.cc\
       $(srcdir)/comp_light.cc $(srcdir)/trm_lcurve.cc $(srcdir)/pylight_curve_comp.cc\
       $(srcdir)/re_scale.cc $(srcdir)/set_disc_grid.cc $(srcdir)/set_disc_continuum.cc\
       $(srcdir)/set_bright_spot_grid.cc $(srcdir)/star_eclipse.cc $(srcdir)/comp_gravity.cc\
       $(srcdir)/comp_radius.cc

objects = pylroche.o numface.o set_star_grid.o set_star_continuum.o pycomp_light.o\
       trm_lcurve.o light_curve_comp.o re_scale.o\
       set_disc_grid.o set_disc_continuum.o set_bright_spot_grid.o\
       star_eclipse.o comp_gravity.o comp_radius.o



lib := libpylcurve.so


$(lib): $(srcs)
	$(CC) -o $@ -fopenmp -shared -fPIC $(LDFLAGS) $(CPPFLAGS) $^
	mv $(lib) $(libdir)/


#$(lib): $(subdir)/$(srcs)
#	$(CC) -fPIC -g -O3 -o $@ $(objects) -shared -lm
#        cp libpsffit.so ../../csstpsf/
# general compilation rules 

#.SUFFIXES:  .cc   .o
#.cc.o:
#	$(CC) -fPIC -c $< -O3 -o $@ $(INCLUDE) $(CPPFLAGS) $(LDFLAGS) -shared -lm

.PHONY:clean
clean:
	-rm $(libdir)/*.so

